<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>behavr tables | Rethomics, a framework for high-throughput behaviour analysis in R</title>
  <meta name="description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="behavr tables | Rethomics, a framework for high-throughput behaviour analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  <meta name="github-repo" content="rethomics/rethomics.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="behavr tables | Rethomics, a framework for high-throughput behaviour analysis in R" />
  
  <meta name="twitter:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  

<meta name="author" content="Quentin Geissmann" />


<meta name="date" content="2019-09-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metadata.html"/>
<link rel="next" href="damr.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110947778-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110947778-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/my_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rethomics Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>Package List and First Steps</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#getting-r"><i class="fa fa-check"></i>Getting R</a></li>
<li><a href="intro.html#the-rethomics-packages">The <code>rethomics</code> packages</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i>Installation</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#cran"><i class="fa fa-check"></i>CRAN</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#devtools"><i class="fa fa-check"></i>devtools</a></li>
</ul></li>
</ul></li>
<li><a href="workflow.html#workflow">The <code>rethomics</code> workflow</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i>Working with metadata files</a><ul>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#what-are-metadata"><i class="fa fa-check"></i>What are metadata?</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#make-them-exhaustive"><i class="fa fa-check"></i>Make them exhaustive</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#put-replicates-together"><i class="fa fa-check"></i>Put replicates together</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#linking-metadata"><i class="fa fa-check"></i>Linking metadata</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#take-home-message"><i class="fa fa-check"></i>Take home message</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html"><i class="fa fa-check"></i>behavr tables</a><ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#variables-and-metavariables"><i class="fa fa-check"></i>Variables and metavariables</a></li>
<li><a href="behavr.html#operating-on-behavr-tables">Operating on <code>behavr</code> tables</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#playing-with-toy-data"><i class="fa fa-check"></i>Playing with toy data</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#generalities"><i class="fa fa-check"></i>Generalities</a><ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#metadata"><i class="fa fa-check"></i>Metadata</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#summarise-data"><i class="fa fa-check"></i>Summarise data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html"><i class="fa fa-check"></i>DAM2 data, in practice</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#getting-the-data"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#from-experiment-design-to-metadata"><i class="fa fa-check"></i>From experiment design to metadata</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#our-toy-experiment"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#metadata-1"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#linking"><i class="fa fa-check"></i>Linking</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#loading"><i class="fa fa-check"></i>Loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#note-on-datetime"><i class="fa fa-check"></i>Note on datetime</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#zt0"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#start-and-stop-time"><i class="fa fa-check"></i>Start and stop time</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#quality-control"><i class="fa fa-check"></i>Quality control</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#detecting-anomalies"><i class="fa fa-check"></i>Detecting anomalies</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#how-to-exclude-animals"><i class="fa fa-check"></i>How to exclude animals?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#apply-functions-when-loading"><i class="fa fa-check"></i>Apply functions when loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#next-steps"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html"><i class="fa fa-check"></i>Ethoscope data, in practice</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#aims-1"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#background-1"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#getting-the-data-1"><i class="fa fa-check"></i>Getting the data</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#extract-the-zipped-data"><i class="fa fa-check"></i>Extract the zipped data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#note-on-the-data-structure"><i class="fa fa-check"></i>Note on the data structure</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#set-your-working-directory"><i class="fa fa-check"></i>Set your working directory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#from-experiment-design-to-metadata-1"><i class="fa fa-check"></i>From experiment design to metadata</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#our-toy-experiment-1"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#metadata-2"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#linking-1"><i class="fa fa-check"></i>Linking</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#local-data"><i class="fa fa-check"></i>Local data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#remote-data"><i class="fa fa-check"></i>Remote Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#loading-1"><i class="fa fa-check"></i>Loading</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#raw-data-default"><i class="fa fa-check"></i>Raw data (default)</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#preprocessing"><i class="fa fa-check"></i>Preprocessing</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#zt0-1"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#cache-directory"><i class="fa fa-check"></i>Cache directory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#quality-control-1"><i class="fa fa-check"></i>Quality control</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#and-then"><i class="fa fa-check"></i>And then?</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#sleep-amount-vs-treatment"><i class="fa fa-check"></i>Sleep amount vs treatment</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#total-sleep-vs-expression-level"><i class="fa fa-check"></i>Total sleep vs expression level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#next-steps-1"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html"><i class="fa fa-check"></i>Visualisation with ggetho</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#aims-2"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#lessons-from-ggplot"><i class="fa fa-check"></i>Lessons from ggplot</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#some-behavioural-data"><i class="fa fa-check"></i>Some behavioural data</a></li>
<li><a href="ggetho.html#the-ggetho-function">The <code>ggetho()</code> function</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#tile-plots"><i class="fa fa-check"></i>Tile plots</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#per-individual"><i class="fa fa-check"></i>Per individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#sorted-individual"><i class="fa fa-check"></i>Sorted individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#group-averages"><i class="fa fa-check"></i>Group averages</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#bar-tiles"><i class="fa fa-check"></i>Bar tiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#population-plots"><i class="fa fa-check"></i>Population plots</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#one-population"><i class="fa fa-check"></i>One population</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#several-populations"><i class="fa fa-check"></i>Several populations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#wrapping-data"><i class="fa fa-check"></i>Wrapping data</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#double-plotted-actograms"><i class="fa fa-check"></i>Double-plotted actograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#faceting-by-id"><i class="fa fa-check"></i>Faceting by ID</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#default"><i class="fa fa-check"></i>Default</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#custom-labeller"><i class="fa fa-check"></i>Custom labeller</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#numerical-labelling"><i class="fa fa-check"></i>Numerical labelling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-annotations"><i class="fa fa-check"></i>LD annotations</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#basics"><i class="fa fa-check"></i>Basics</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#changing-ld-colours"><i class="fa fa-check"></i>Changing LD colours</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-in-the-background"><i class="fa fa-check"></i>LD in the background</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#phase-and-period"><i class="fa fa-check"></i>Phase and period</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#regime-change"><i class="fa fa-check"></i>Regime change</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-and-scales"><i class="fa fa-check"></i>Coordinate and scales</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#plot-limits"><i class="fa fa-check"></i>Plot limits</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#time-scale-units"><i class="fa fa-check"></i>Time scale units</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-systems"><i class="fa fa-check"></i>Coordinate systems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#periodograms"><i class="fa fa-check"></i>Periodograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#spectrograms"><i class="fa fa-check"></i>Spectrograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#take-home-message-1"><i class="fa fa-check"></i>Take home message</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#next-steps-2"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html"><i class="fa fa-check"></i>Sleep analysis</a><ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#aims-3"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#background-2"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#getting-the-data-2"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#data-curation"><i class="fa fa-check"></i>Data curation</a><ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#dead-animals"><i class="fa fa-check"></i>Dead animals</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#animals-that-died-too-early"><i class="fa fa-check"></i>Animals that died too early</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#trimming"><i class="fa fa-check"></i>Trimming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#population-plots-1"><i class="fa fa-check"></i>Population plots</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#summarise-data-per-animal"><i class="fa fa-check"></i>Summarise data per animal</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#day-sleep-night-sleep"><i class="fa fa-check"></i>Day sleep☼ – Night sleep☾</a><ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#adding-some-phase-information"><i class="fa fa-check"></i>Adding some phase information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#statistics"><i class="fa fa-check"></i>Statistics</a><ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#pairwise-wilcoxon-tests"><i class="fa fa-check"></i>Pairwise Wilcoxon tests</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#two-way-anova"><i class="fa fa-check"></i>Two way anova</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#sleep-architecture"><i class="fa fa-check"></i>Sleep architecture</a><ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#bout-analysis"><i class="fa fa-check"></i>Bout analysis</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#bout-length-vs-time-of-the-day"><i class="fa fa-check"></i>Bout length vs time of the day</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#architecture-description"><i class="fa fa-check"></i>Architecture description</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#latency-to-sleep"><i class="fa fa-check"></i>Latency to sleep</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#merging-all-statistics"><i class="fa fa-check"></i>Merging all statistics</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#take-home-message-2"><i class="fa fa-check"></i>Take home message</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#next-steps-3"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html"><i class="fa fa-check"></i>Circadian rhythm analysis</a><ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#aims-4"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#background-3"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#getting-the-data-3"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#quality-control-2"><i class="fa fa-check"></i>Quality control</a><ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#regime-changes"><i class="fa fa-check"></i>Regime changes</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#data-enrichment"><i class="fa fa-check"></i>Data enrichment</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#overview-plots"><i class="fa fa-check"></i>Overview plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#double-plotted-actograms-1"><i class="fa fa-check"></i>Double plotted actograms</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#periodograms-1"><i class="fa fa-check"></i>Periodograms</a><ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#computation"><i class="fa fa-check"></i>Computation</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#peaks-finding"><i class="fa fa-check"></i>Peaks finding</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#visualisation"><i class="fa fa-check"></i>Visualisation</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#exctract-the-peak-values"><i class="fa fa-check"></i>Exctract the peak values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#next-steps-4"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html"><i class="fa fa-check"></i>Issues and community</a><ul>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#citation"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#having-troubles"><i class="fa fa-check"></i>Having troubles</a></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#contributing"><i class="fa fa-check"></i>Contributing</a></li>
</ul></li>
<li class="divider"></li>
<li>
<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0209331" target="blank">Cite rethomics</a>
<a href="https://bookdown.org/yihui/bookdown/" target="blank">Published with bookdown</a>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rethomics, a framework for high-throughput behaviour analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="behavr" class="section level1 unnumbered">
<h1>behavr tables</h1>
<p><strong>A single data structure to store data and metadata</strong></p>
<hr />
<div class="figure">
<img src="assets/behavr.png" alt="a behavr table" />
<p class="caption">a behavr table</p>
</div>
<div id="variables-and-metavariables" class="section level2 unnumbered">
<h2>Variables and metavariables</h2>
<p>As we have seen in the <a href="metadata.html">previous section</a>, metadata are crucial for proper statistical analysis of the experimental <strong>data</strong>. In the context of ethomics, the data are long time series of recorded <strong>variables</strong> such as position, orientation and number of beam crosses, for each individual. <strong>Variables</strong> are different form <strong>metavariables</strong> in so far as the latter are made of only one value per animal. It is easier (and less error prone) to always keep the data and metadata together. In rethomics, in order to handle large amounts of data (together with metadata), we have designed the <code>behavr</code> package. <code>behavr</code> tables are based on the very powerful package <code>data.table</code>, but enhanced with metadata. A <code>behavr</code> table is, indeed, formed internally by two tables: the metadata table and the data table, both are linked by the <code>id</code> column (see figure above).</p>
<p>For most purposes, you can use a <code>behavr</code> table just like a <code>data.table</code>. Therefore, do take a look at the <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html">introduction to <code>data.table</code></a> for further details! <strong>When we load any behavioural data in <code>rethomics</code>, we get a <code>behavr</code> table as a result.</strong> In this section, we will discuss the usual operations that you can perform on <code>behavr</code> tables.</p>
</div>
<div id="operating-on-behavr-tables" class="section level2 unnumbered">
<h2>Operating on <code>behavr</code> tables</h2>
<p>Now that we have all our data at the same place, we want to be able to manipulate it. In the next part of this tutorial, we will create some toy data and learn how to manipulate it. This is where basic knowledge of <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html"><code>data.table</code></a> comes in handy. The following table is an overview of operations in <code>behavr</code> tables. <code>DT</code> represents an <code>behavr</code> table.</p>
<table>
<thead>
<tr class="header">
<th align="left">Section</th>
<th align="left">Operation</th>
<th align="left">Expression</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Generalities</td>
<td align="left">Summarise <code>behavr</code> table</td>
<td align="left"><code>summary(DT)</code></td>
<td align="left">How many individuals, variables, metavariables, etc? – <code>summary(dt)</code></td>
</tr>
<tr class="even">
<td align="left">Pure data</td>
<td align="left"><strong>Create</strong>/alter a variable</td>
<td align="left"><code>DT[, new_column := some_value]</code></td>
<td align="left">When are animals ‘very active’? – <code>dt[, very_active := activity &gt;= 2]</code></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><strong>Remove</strong> a variable</td>
<td align="left"><code>DT[, column_to_delete := NULL]</code></td>
<td align="left">Lets remove a variable we don’t need? – <code>dt[, very_active := NULL]</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong>Select</strong> data rows</td>
<td align="left"><code>DT[criteria]</code></td>
<td align="left">Exclude data before the first hour – <code>small_dt &lt;- dt[t &gt; hours(1)]</code></td>
</tr>
<tr class="odd">
<td align="left">Pure metadata</td>
<td align="left">Access metadata table</td>
<td align="left"><code>DT[meta = TRUE]</code></td>
<td align="left">Show metadata as table – <code>dt[meta = TRUE]</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong>Create</strong>/alter metavariable</td>
<td align="left"><code>DT[, new_meta := some_value, meta=TRUE]</code></td>
<td align="left">Define a new factor that is a comibiation of ‘sex x condition’ – <code>dt[, treatment := paste(sex, condition, sep='|'), meta=T]</code></td>
</tr>
<tr class="odd">
<td align="left">Meta &amp; data</td>
<td align="left">Use <strong>metavariable as variable</strong></td>
<td align="left"><code>xmv(metavariable)</code></td>
<td align="left">Add 10s to all time, only for animals in condition <code>'A'</code> – <code>dt[, t := ifelse(xmv(condition) == 'A', t + 10, t)]</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong>Remove individuals</strong> according to metavariable</td>
<td align="left"><code>DT[criteria]</code></td>
<td align="left">Remove all males (from data, and metadata) – <code>dt_females &lt;- dt[xmv(sex) == 'females']</code></td>
</tr>
<tr class="odd">
<td align="left">Summarise</td>
<td align="left">Compute <strong>individual statistics</strong></td>
<td align="left"><code>DT[, .( statistics = some_math()), by='id']</code></td>
<td align="left">Compute the average activity, per animal – <code>stat_dt &lt;- dt[, .(mean_acti = mean(active)), by='id']</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong>Rejoin</strong> metadata to data</td>
<td align="left"><code>rejoin(DT)</code></td>
<td align="left">Merge metadata and summary statistics – <code>stat_dt &lt;- rejoin(stat_dt)</code></td>
</tr>
<tr class="odd">
<td align="left">Advanced</td>
<td align="left"><strong>Stitch</strong> experiments</td>
<td align="left"><code>stitch_on(DT, metavariable)</code></td>
<td align="left">TODO – TODO</td>
</tr>
</tbody>
</table>
</div>
<div id="playing-with-toy-data" class="section level2 unnumbered">
<h2>Playing with toy data</h2>
<p>The <code>behavr</code> package has a set of functions to make toy data. This provides us with a playgound to test functions and plots without having to get any real data. In order to understand <code>behavr</code> object, lets create a toy one. First, we make some dummy metadata (always needed to create a <code>behavr</code> table):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(behavr)</code></pre></div>
<pre><code>## Loading required package: data.table</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metadata &lt;-<span class="st"> </span><span class="kw">data.table</span>( <span class="dt">id =</span> <span class="kw">paste</span>(<span class="st">&quot;toy_experiment&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">sep =</span> <span class="st">&quot;|&quot;</span>),
                      <span class="dt">sex =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>), <span class="dt">each =</span> <span class="dv">5</span>),
                      <span class="dt">condition =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>) )
metadata</code></pre></div>
<pre><code>##                    id    sex condition
##  1:  toy_experiment|1   male         A
##  2:  toy_experiment|2   male         B
##  3:  toy_experiment|3   male         A
##  4:  toy_experiment|4   male         B
##  5:  toy_experiment|5   male         A
##  6:  toy_experiment|6 female         B
##  7:  toy_experiment|7 female         A
##  8:  toy_experiment|8 female         B
##  9:  toy_experiment|9 female         A
## 10: toy_experiment|10 female         B</code></pre>
<p>This metadata describes an hypothetical experiment with ten animals (<code>1:10</code>, five males and five females). They are exposed to two conditions (<code>&quot;A&quot;</code> and <code>&quot;B&quot;</code>). Then, we use <code>toy_dam_data()</code> to <strong>simulate</strong> (instead of linking/loading) one day of DAMS-like data for these ten animals (and two conditions):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span><span class="kw">toy_dam_data</span>(metadata, <span class="dt">duration =</span> <span class="kw">days</span>(<span class="dv">1</span>))
dt</code></pre></div>
<pre><code>## 
##  ==== METADATA ====
## 
##                    id    sex condition
##                &lt;char&gt; &lt;char&gt;    &lt;char&gt;
##  1:  toy_experiment|1   male         A
##  2: toy_experiment|10 female         B
##  3:  toy_experiment|2   male         B
##  4:  toy_experiment|3   male         A
##  5:  toy_experiment|4   male         B
##  6:  toy_experiment|5   male         A
##  7:  toy_experiment|6 female         B
##  8:  toy_experiment|7 female         A
##  9:  toy_experiment|8 female         B
## 10:  toy_experiment|9 female         A
## 
##  ====== DATA ======
## 
##                      id     t activity
##                  &lt;char&gt; &lt;num&gt;    &lt;int&gt;
##     1: toy_experiment|1     0        0
##     2: toy_experiment|1    60        2
##     3: toy_experiment|1   120        0
##     4: toy_experiment|1   180        1
##     5: toy_experiment|1   240        0
##    ---                                
## 14406: toy_experiment|9 86160        0
## 14407: toy_experiment|9 86220        0
## 14408: toy_experiment|9 86280        2
## 14409: toy_experiment|9 86340        1
## 14410: toy_experiment|9 86400        0</code></pre>
<p>As you can see, when we print <code>dt</code>, our <code>behavr</code> table, we have two sections: <code>METADATA</code> and <code>DATA</code>. The former is actually just the metadata we created whilst the latter stores the data (i.e. the variables) for <strong>all animals</strong>. The special column <code>id</code> is also known as a <strong>key</strong>, and is shared between both data and metadata. It internally allows us to map them to one another. In other words, it is a unique id for each individual. In this specific example, the variables <code>t</code> and <code>activity</code> are the time and the number of beam crosses, respectively.</p>
</div>
<div id="generalities" class="section level2 unnumbered">
<h2>Generalities</h2>
<p>A quick way to retreive general information about a <code>behavr</code> table is to use <code>summary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt)</code></pre></div>
<pre><code>## behavr table with:
##  10  individuals
##  2   metavariables
##  2   variables
##  1.441e+04   measurements
##  1   key (id)</code></pre>
<p>This tells us immediately how many variables, metavariables and data points, we have.</p>
<p>One can also print a detailed summary (i.e. one per animal):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt, <span class="dt">detailed =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Summary of each individual (one per row):
##                    id    sex condition data_points           time_range
##  1:  toy_experiment|1   male         A        1441 [0 -&gt; 86400 (86400)]
##  2: toy_experiment|10 female         B        1441 [0 -&gt; 86400 (86400)]
##  3:  toy_experiment|2   male         B        1441 [0 -&gt; 86400 (86400)]
##  4:  toy_experiment|3   male         A        1441 [0 -&gt; 86400 (86400)]
##  5:  toy_experiment|4   male         B        1441 [0 -&gt; 86400 (86400)]
##  6:  toy_experiment|5   male         A        1441 [0 -&gt; 86400 (86400)]
##  7:  toy_experiment|6 female         B        1441 [0 -&gt; 86400 (86400)]
##  8:  toy_experiment|7 female         A        1441 [0 -&gt; 86400 (86400)]
##  9:  toy_experiment|8 female         B        1441 [0 -&gt; 86400 (86400)]
## 10:  toy_experiment|9 female         A        1441 [0 -&gt; 86400 (86400)]</code></pre>
<div id="data" class="section level3 unnumbered">
<h3>Data</h3>
<p>Playing with variables is just like in <code>data.table</code>. Read the <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html">official data.table tutorial</a> for more functionalities.</p>
<p>For instance, we can add a <strong>new variable</strong>, <code>very_active</code>, that is <code>TRUE</code> if and only if there was at least two beam crosses in a minute, for a given individual:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[, very_active <span class="op">:</span><span class="er">=</span><span class="st"> </span>activity <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>]</code></pre></div>
<p>If we decide we don’t need this variable anymore, we can <strong>remove it</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[, very_active <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]</code></pre></div>
<p>Sometimes, we would like to <strong>filter the data</strong>. That is, we select rows according to one or several criteria. Often we would like to exclude the very start of the experiment. For example, we can keep data after one hour:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span>dt[ t <span class="op">&gt;</span><span class="st"> </span><span class="kw">hours</span>(<span class="dv">1</span>)]</code></pre></div>
<p>Note that that using <code>dt &lt;-</code> mean we make a new table that overwrite the old one (since it has the same name).</p>
</div>
<div id="metadata" class="section level3 unnumbered">
<h3>Metadata</h3>
<p>In order to access the metadata, we can add <code>meta = TRUE</code> inside the <code>[]</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[meta =<span class="st"> </span><span class="ot">TRUE</span>]</code></pre></div>
<pre><code>##                    id    sex condition
##  1:  toy_experiment|1   male         A
##  2: toy_experiment|10 female         B
##  3:  toy_experiment|2   male         B
##  4:  toy_experiment|3   male         A
##  5:  toy_experiment|4   male         B
##  6:  toy_experiment|5   male         A
##  7:  toy_experiment|6 female         B
##  8:  toy_experiment|7 female         A
##  9:  toy_experiment|8 female         B
## 10:  toy_experiment|9 female         A</code></pre>
<p>This way, we can also <strong>create new metavariables</strong>. For instance, say you want to collapse <code>sex</code> and <code>condition</code> which both have two levels into one <code>treatment</code>, with four levels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[, treatment <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(sex, condition, <span class="dt">sep=</span><span class="st">&#39;|&#39;</span>), meta=T]
<span class="co"># just to show the result:</span>
dt[meta =<span class="st"> </span><span class="ot">TRUE</span>]</code></pre></div>
<pre><code>##                    id    sex condition treatment
##  1:  toy_experiment|1   male         A    male|A
##  2: toy_experiment|10 female         B  female|B
##  3:  toy_experiment|2   male         B    male|B
##  4:  toy_experiment|3   male         A    male|A
##  5:  toy_experiment|4   male         B    male|B
##  6:  toy_experiment|5   male         A    male|A
##  7:  toy_experiment|6 female         B  female|B
##  8:  toy_experiment|7 female         A  female|A
##  9:  toy_experiment|8 female         B  female|B
## 10:  toy_experiment|9 female         A  female|A</code></pre>
<p><code>paste()</code> is a function that links strings of characters with an arbitrary separator (<code>&quot;|&quot;</code> here).</p>
<p>New metavariables can also be added from a summary (see <a href="behavr.html#summarise-data">Summarise data</a>). ### Data &amp; Metadata {-}</p>
<p>The strength of <code>behavr</code> tables is their ability to seamlessly <strong>use metavariables as though they were variables</strong>. For the sake of the example, let’s say you would like to alter the variable <code>t</code> (time) so that we add ten seconds, <em>only to individuals that have condition <code>'A'</code></em>.</p>
<pre><code>dt[, t := ifelse(xmv(condition) == &#39;A&#39;, t + 10, t)]</code></pre>
<p>The key here is the use of <code>xmv</code> (eXpand MetaVariable), which maps <code>condition</code> back in the data.</p>
<p>We can also use this mechanism to <strong>remove individuals according to the value of a metavariable</strong>. For instance, lets get rid of the males!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span>dt[<span class="kw">xmv</span>(sex) <span class="op">==</span><span class="st"> &#39;female&#39;</span>]
<span class="kw">summary</span>(dt)</code></pre></div>
<pre><code>## behavr table with:
##  5   individuals
##  3   metavariables
##  2   variables
##  6.9e+03 measurements
##  1   key (id)</code></pre>
<p>When individuals are removed, metadata is automatically updated. In effect, we removed males from both data and metadata. This operation cannot be undone, as we overwrite <code>dt</code> with a new value. An alternative would be to save the result in a new table (e.g. <code>dt_females &lt;- dt[xmv(sex) == 'female']</code>) This would use some additional memory, but it is safer.</p>
</div>
<div id="summarise-data" class="section level3 unnumbered">
<h3>Summarise data</h3>
<p>Thanks to <code>data.table</code> <code>by</code> operations, it is simple and efficient to <strong>compute statistics per individual</strong>. For instance, we may want to compute the average activity for each animal:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat_dt &lt;-<span class="st"> </span>dt[,
   .(<span class="dt">mean_acti =</span> <span class="kw">mean</span>(activity)),
   by=<span class="st">&#39;id&#39;</span>]
stat_dt</code></pre></div>
<pre><code>## 
##  ==== METADATA ====
## 
##                   id    sex condition treatment
##               &lt;char&gt; &lt;char&gt;    &lt;char&gt;    &lt;char&gt;
## 1: toy_experiment|10 female         B  female|B
## 2:  toy_experiment|6 female         B  female|B
## 3:  toy_experiment|7 female         A  female|A
## 4:  toy_experiment|8 female         B  female|B
## 5:  toy_experiment|9 female         A  female|A
## 
##  ====== DATA ======
## 
##                   id mean_acti
##               &lt;char&gt;     &lt;num&gt;
## 1: toy_experiment|10 0.4420290
## 2:  toy_experiment|6 0.1615942
## 3:  toy_experiment|7 0.4434783
## 4:  toy_experiment|8 0.1731884
## 5:  toy_experiment|9 0.2550725</code></pre>
<p>You can actually compute many variables in one go this way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat_dt &lt;-<span class="st"> </span>dt[,
   .(<span class="dt">mean_acti =</span> <span class="kw">mean</span>(activity),
     <span class="dt">max_acti =</span> <span class="kw">max</span>(activity)
     ),
   by=<span class="st">&#39;id&#39;</span>]
stat_dt</code></pre></div>
<pre><code>## 
##  ==== METADATA ====
## 
##                   id    sex condition treatment
##               &lt;char&gt; &lt;char&gt;    &lt;char&gt;    &lt;char&gt;
## 1: toy_experiment|10 female         B  female|B
## 2:  toy_experiment|6 female         B  female|B
## 3:  toy_experiment|7 female         A  female|A
## 4:  toy_experiment|8 female         B  female|B
## 5:  toy_experiment|9 female         A  female|A
## 
##  ====== DATA ======
## 
##                   id mean_acti max_acti
##               &lt;char&gt;     &lt;num&gt;    &lt;int&gt;
## 1: toy_experiment|10 0.4420290        3
## 2:  toy_experiment|6 0.1615942        2
## 3:  toy_experiment|7 0.4434783        3
## 4:  toy_experiment|8 0.1731884        2
## 5:  toy_experiment|9 0.2550725        2</code></pre>
<p>Then, if needed, this summary can be added back to the metadata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create new metadata table by joining current meta and the summary table</span>
new_meta &lt;-<span class="st"> </span>dt[stat_dt, meta=T]
<span class="co"># set new metadata</span>
<span class="kw">setmeta</span>(dt, new_meta)
<span class="kw">head</span>(dt[<span class="dt">meta=</span>T])</code></pre></div>
<pre><code>##                   id    sex condition treatment mean_acti max_acti
## 1: toy_experiment|10 female         B  female|B 0.4420290        3
## 2:  toy_experiment|6 female         B  female|B 0.1615942        2
## 3:  toy_experiment|7 female         A  female|A 0.4434783        3
## 4:  toy_experiment|8 female         B  female|B 0.1731884        2
## 5:  toy_experiment|9 female         A  female|A 0.2550725        2</code></pre>
<p>This way we can store per-individual aggregates and visualise or analyse them with respect to the pre-existing metadata.</p>
<p>Now, in order to perform statistics, we would like to merge our summaries to the metadata. This way we end up with only one <code>data.table</code> That is, we want to <strong>rejoin</strong> them to one another (i.e. we enrich our summaries with the metadata):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">final_dt &lt;-<span class="st"> </span><span class="kw">rejoin</span>(stat_dt)
final_dt</code></pre></div>
<pre><code>##                   id    sex condition treatment mean_acti max_acti
## 1: toy_experiment|10 female         B  female|B 0.4420290        3
## 2:  toy_experiment|6 female         B  female|B 0.1615942        2
## 3:  toy_experiment|7 female         A  female|A 0.4434783        3
## 4:  toy_experiment|8 female         B  female|B 0.1731884        2
## 5:  toy_experiment|9 female         A  female|A 0.2550725        2</code></pre>
<p>This table is exactly what you need for statistics and visualisation in <code>R</code>!</p>
<!-- ### Stitching{-} -->
<!-- TODO -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metadata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="damr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rethomics/rethomics.github.io/edit/source/04-behavr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["rethomics.pdf", "rethomics.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
