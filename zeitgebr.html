<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Circadian rhythm analysis | Rethomics, a framework for high-throughput behaviour analysis in R</title>
  <meta name="description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Circadian rhythm analysis | Rethomics, a framework for high-throughput behaviour analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  <meta name="github-repo" content="rethomics/rethomics.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Circadian rhythm analysis | Rethomics, a framework for high-throughput behaviour analysis in R" />
  
  <meta name="twitter:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in R." />
  

<meta name="author" content="Quentin Geissmann" />


<meta name="date" content="2022-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sleepr.html"/>
<link rel="next" href="community.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110947778-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110947778-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/my_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rethomics Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>Package List and First Steps</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#getting-r"><i class="fa fa-check"></i>Getting R</a></li>
<li><a href="intro.html#the-rethomics-packages">The <code>rethomics</code> packages</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i>Installation</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#cran"><i class="fa fa-check"></i>CRAN</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#devtools"><i class="fa fa-check"></i>devtools</a></li>
</ul></li>
</ul></li>
<li><a href="workflow.html#workflow">The <code>rethomics</code> workflow</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i>Working with metadata files</a>
<ul>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#what-are-metadata"><i class="fa fa-check"></i>What are metadata?</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#make-them-exhaustive"><i class="fa fa-check"></i>Make them exhaustive</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#put-replicates-together"><i class="fa fa-check"></i>Put replicates together</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#linking-metadata"><i class="fa fa-check"></i>Linking metadata</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#take-home-message"><i class="fa fa-check"></i>Take home message</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html"><i class="fa fa-check"></i>behavr tables</a>
<ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#variables-and-metavariables"><i class="fa fa-check"></i>Variables and metavariables</a></li>
<li><a href="behavr.html#operating-on-behavr-tables">Operating on <code>behavr</code> tables</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#playing-with-toy-data"><i class="fa fa-check"></i>Playing with toy data</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#generalities"><i class="fa fa-check"></i>Generalities</a>
<ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#metadata-1"><i class="fa fa-check"></i>Metadata</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#summarise-data"><i class="fa fa-check"></i>Summarise data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html"><i class="fa fa-check"></i>DAM2 data, in practice</a>
<ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#getting-the-data"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#from-experiment-design-to-metadata"><i class="fa fa-check"></i>From experiment design to metadata</a>
<ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#our-toy-experiment"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#metadata-2"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#linking"><i class="fa fa-check"></i>Linking</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#loading"><i class="fa fa-check"></i>Loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#note-on-datetime"><i class="fa fa-check"></i>Note on datetime</a>
<ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#zt0"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#start-and-stop-time"><i class="fa fa-check"></i>Start and stop time</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#quality-control"><i class="fa fa-check"></i>Quality control</a>
<ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#detecting-anomalies"><i class="fa fa-check"></i>Detecting anomalies</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#how-to-exclude-animals"><i class="fa fa-check"></i>How to exclude animals?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#apply-functions-when-loading"><i class="fa fa-check"></i>Apply functions when loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#next-steps"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html"><i class="fa fa-check"></i>Ethoscope data, in practice</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#aims-1"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#background-1"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#getting-the-data-1"><i class="fa fa-check"></i>Getting the data</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#extract-the-zipped-data"><i class="fa fa-check"></i>Extract the zipped data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#note-on-the-data-structure"><i class="fa fa-check"></i>Note on the data structure</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#set-your-working-directory"><i class="fa fa-check"></i>Set your working directory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#from-experiment-design-to-metadata-1"><i class="fa fa-check"></i>From experiment design to metadata</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#our-toy-experiment-1"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#metadata-3"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#linking-1"><i class="fa fa-check"></i>Linking</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#local-data"><i class="fa fa-check"></i>Local data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#remote-data"><i class="fa fa-check"></i>Remote Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#loading-1"><i class="fa fa-check"></i>Loading</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#raw-data-default"><i class="fa fa-check"></i>Raw data (default)</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#preprocessing"><i class="fa fa-check"></i>Preprocessing</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#zt0-1"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#cache-directory"><i class="fa fa-check"></i>Cache directory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#quality-control-1"><i class="fa fa-check"></i>Quality control</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#and-then"><i class="fa fa-check"></i>And then?</a>
<ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#sleep-amount-vs-treatment"><i class="fa fa-check"></i>Sleep amount vs treatment</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#total-sleep-vs-expression-level"><i class="fa fa-check"></i>Total sleep vs expression level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#next-steps-1"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html"><i class="fa fa-check"></i>Visualisation with ggetho</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#aims-2"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#lessons-from-ggplot"><i class="fa fa-check"></i>Lessons from ggplot</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#some-behavioural-data"><i class="fa fa-check"></i>Some behavioural data</a></li>
<li><a href="ggetho.html#the-ggetho-function">The <code>ggetho()</code> function</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#tile-plots"><i class="fa fa-check"></i>Tile plots</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#per-individual"><i class="fa fa-check"></i>Per individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#sorted-individual"><i class="fa fa-check"></i>Sorted individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#group-averages"><i class="fa fa-check"></i>Group averages</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#bar-tiles"><i class="fa fa-check"></i>Bar tiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#population-plots"><i class="fa fa-check"></i>Population plots</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#one-population"><i class="fa fa-check"></i>One population</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#several-populations"><i class="fa fa-check"></i>Several populations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#wrapping-data"><i class="fa fa-check"></i>Wrapping data</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#double-plotted-actograms"><i class="fa fa-check"></i>Double-plotted actograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#faceting-by-id"><i class="fa fa-check"></i>Faceting by ID</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#default"><i class="fa fa-check"></i>Default</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#custom-labeller"><i class="fa fa-check"></i>Custom labeller</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#numerical-labelling"><i class="fa fa-check"></i>Numerical labelling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-annotations"><i class="fa fa-check"></i>LD annotations</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#basics"><i class="fa fa-check"></i>Basics</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#changing-ld-colours"><i class="fa fa-check"></i>Changing LD colours</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-in-the-background"><i class="fa fa-check"></i>LD in the background</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#phase-and-period"><i class="fa fa-check"></i>Phase and period</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#regime-change"><i class="fa fa-check"></i>Regime change</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-and-scales"><i class="fa fa-check"></i>Coordinate and scales</a>
<ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#plot-limits"><i class="fa fa-check"></i>Plot limits</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#time-scale-units"><i class="fa fa-check"></i>Time scale units</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-systems"><i class="fa fa-check"></i>Coordinate systems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#periodograms"><i class="fa fa-check"></i>Periodograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#spectrograms"><i class="fa fa-check"></i>Spectrograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#take-home-message-1"><i class="fa fa-check"></i>Take home message</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#next-steps-2"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html"><i class="fa fa-check"></i>Sleep analysis</a>
<ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#aims-3"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#background-2"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#getting-the-data-2"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#data-curation"><i class="fa fa-check"></i>Data curation</a>
<ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#dead-animals"><i class="fa fa-check"></i>Dead animals</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#animals-that-died-too-early"><i class="fa fa-check"></i>Animals that died too early</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#trimming"><i class="fa fa-check"></i>Trimming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#population-plots-1"><i class="fa fa-check"></i>Population plots</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#summarise-data-per-animal"><i class="fa fa-check"></i>Summarise data per animal</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#day-sleep-night-sleep"><i class="fa fa-check"></i>Day sleep☼ – Night sleep☾</a>
<ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#adding-some-phase-information"><i class="fa fa-check"></i>Adding some phase information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#statistics"><i class="fa fa-check"></i>Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#pairwise-wilcoxon-tests"><i class="fa fa-check"></i>Pairwise Wilcoxon tests</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#two-way-anova"><i class="fa fa-check"></i>Two way anova</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#sleep-architecture"><i class="fa fa-check"></i>Sleep architecture</a>
<ul>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#bout-analysis"><i class="fa fa-check"></i>Bout analysis</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#bout-length-vs-time-of-the-day"><i class="fa fa-check"></i>Bout length vs time of the day</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#architecture-description"><i class="fa fa-check"></i>Architecture description</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#latency-to-sleep"><i class="fa fa-check"></i>Latency to sleep</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#merging-all-statistics"><i class="fa fa-check"></i>Merging all statistics</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#take-home-message-2"><i class="fa fa-check"></i>Take home message</a></li>
<li class="chapter" data-level="" data-path="sleepr.html"><a href="sleepr.html#next-steps-3"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html"><i class="fa fa-check"></i>Circadian rhythm analysis</a>
<ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#aims-4"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#background-3"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#getting-the-data-3"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#quality-control-2"><i class="fa fa-check"></i>Quality control</a>
<ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#regime-changes"><i class="fa fa-check"></i>Regime changes</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#data-enrichment"><i class="fa fa-check"></i>Data enrichment</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#overview-plots"><i class="fa fa-check"></i>Overview plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#double-plotted-actograms-1"><i class="fa fa-check"></i>Double plotted actograms</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#periodograms-1"><i class="fa fa-check"></i>Periodograms</a>
<ul>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#computation"><i class="fa fa-check"></i>Computation</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#peaks-finding"><i class="fa fa-check"></i>Peaks finding</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#visualisation"><i class="fa fa-check"></i>Visualisation</a></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#exctract-the-peak-values"><i class="fa fa-check"></i>Exctract the peak values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zeitgebr.html"><a href="zeitgebr.html#next-steps-4"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html"><i class="fa fa-check"></i>Issues and community</a>
<ul>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#citation"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#having-troubles"><i class="fa fa-check"></i>Having troubles</a></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#contributing"><i class="fa fa-check"></i>Contributing</a></li>
<li class="chapter" data-level="" data-path="community.html"><a href="community.html#related-projects"><i class="fa fa-check"></i>Related projects</a></li>
</ul></li>
<li class="divider"></li>
<li>
<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0209331" target="blank">Cite rethomics</a>
<a href="https://bookdown.org/yihui/bookdown/" target="blank">Published with bookdown</a>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rethomics, a framework for high-throughput behaviour analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="zeitgebr" class="section level1 unnumbered">
<h1>Circadian rhythm analysis</h1>
<!-- **TODO the perfect one liner** -->
<!-- --------------------------- -->
<!-- ![TODO add some figure]("rethomics_files/figure-html/achitecture-1.png") -->
<div id="aims-4" class="section level2 unnumbered">
<h2>Aims</h2>
<p>In this practical chapter, we will use a real experiment to learn how to:</p>
<ul>
<li>Use <code>zeitgebr</code> to compute periodograms</li>
<li>Use <a href="ggetho.html">ggetho</a> to draw double plotted actograms</li>
<li>Average periodograms vs conditions</li>
<li>Find and compare peaks</li>
</ul>
</div>
<div id="prerequisites-4" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<ul>
<li>You have read about <a href="behavr.html">behavr tables</a></li>
<li>You are familiar with <a href="ggetho.html">ggetho</a>, our visualisation tool</li>
<li>You have already read the <a href="damr.html">damr tutorial</a></li>
<li>Ensure you have <a href="intro.html#installing-rethomics-packages">installed</a>
<code>behavr</code>, <code>damr</code>, <code>ggetho</code> and <code>zeitgebr</code> packages</li>
</ul>
</div>
<div id="background-3" class="section level2 unnumbered">
<h2>Background</h2>
<p>This tutorial focuses on circadian rhythm in <em>Drosophila</em>, but can be adapted easily to investigate periodicity in different contexts.
In it, we will use a DAM dataset that is provided (and preloaded) within the <code>damr</code> package.</p>
</div>
<div id="getting-the-data-3" class="section level2 unnumbered">
<h2>Getting the data</h2>
<p>Getting the data is a lot simpler than in the other tutorials as it is already on your computer:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="zeitgebr.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(damr)</span>
<span id="cb171-2"><a href="zeitgebr.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zeitgebr)</span>
<span id="cb171-3"><a href="zeitgebr.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggetho)</span>
<span id="cb171-4"><a href="zeitgebr.html#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="zeitgebr.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the data</span></span>
<span id="cb171-6"><a href="zeitgebr.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dams_sample) </span>
<span id="cb171-7"><a href="zeitgebr.html#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We copy the data to our own variable so we can alter it</span></span>
<span id="cb171-8"><a href="zeitgebr.html#cb171-8" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">copy</span>(dams_sample) </span></code></pre></div>
<p>This data set is a recording of 32 animals, in DD.
Let us print the metadata to understand the experiment a little bit:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="zeitgebr.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dt)</span></code></pre></div>
<pre><code>## behavr table with:
##  32  individuals
##  6   metavariables
##  2   variables
##  4.1504e+05  measurements
##  1   key (id)</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="zeitgebr.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dt[<span class="at">meta=</span>T])</span></code></pre></div>
<pre><code>##                                         id file_info region_id
##  1: 2017-01-16 08:00:00|dams_sample.txt|01 &lt;list[2]&gt;         1
##  2: 2017-01-16 08:00:00|dams_sample.txt|02 &lt;list[2]&gt;         2
##  3: 2017-01-16 08:00:00|dams_sample.txt|03 &lt;list[2]&gt;         3
##  4: 2017-01-16 08:00:00|dams_sample.txt|04 &lt;list[2]&gt;         4
##  5: 2017-01-16 08:00:00|dams_sample.txt|05 &lt;list[2]&gt;         5
## ---                                                           
## 28: 2017-01-16 08:00:00|dams_sample.txt|28 &lt;list[2]&gt;        28
## 29: 2017-01-16 08:00:00|dams_sample.txt|29 &lt;list[2]&gt;        29
## 30: 2017-01-16 08:00:00|dams_sample.txt|30 &lt;list[2]&gt;        30
## 31: 2017-01-16 08:00:00|dams_sample.txt|31 &lt;list[2]&gt;        31
## 32: 2017-01-16 08:00:00|dams_sample.txt|32 &lt;list[2]&gt;        32
##                           experiment_id      start_datetime       stop_datetime
##  1: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  2: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  3: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  4: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  5: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## ---                                                                            
## 28: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 29: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 30: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 31: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 32: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##     period_group
##  1:         long
##  2:         long
##  3:         long
##  4:         long
##  5:         long
## ---             
## 28:           wt
## 29:           wt
## 30:           wt
## 31:           wt
## 32:           wt</code></pre>
<p>We can confirm we have 32 individuals.
They are described by one of three “period groups” (e.g. a genotype or treatment).
This is encoded in <code>period_group</code> metavariable can be either a “short”“,”long”” or wild-type (“wt”) period.</p>
</div>
<div id="quality-control-2" class="section level2 unnumbered">
<h2>Quality control</h2>
<p>This data is fairly clean already, so we will not do much.
For most purposes, you can apply the same principles as <a href="sleepr.html#data-curation">data curation for sleep analysis</a>.</p>
<div id="regime-changes" class="section level3 unnumbered">
<h3>Regime changes</h3>
<p>In general (but not here), you will have a period of <code>LD</code> <strong>“baseline”</strong> preceding a change to a <code>DD</code> regime.
I suggest to encode that in the following way:</p>
<ol style="list-style-type: decimal">
<li>Manually add a column <code>baseline_days</code> in your metadata that defines the <strong>number of days of baseline</strong>.</li>
<li><strong>Sustract the number of baseline days</strong> to all time points: <code>dt[, t := t - days(xmv(baseline_days))]</code></li>
</ol>
<p>As a result, <code>t = 0</code> now means “ZT0 of the transition day”.
This makes a lot of sense as any baseline point is at a negative time (<code>t &lt; 0</code>), whilst <code>t &gt; 0</code> is for <code>DD</code>.
The nice thing is that you can work with data (e.g. replicates) that have different baseline duration as now <strong>all time points are relative to the regime change</strong>.</p>
</div>
<div id="data-enrichment" class="section level3 unnumbered">
<h3>Data enrichment</h3>
<p>By defaut, DAM data only has variables <code>t</code> and <code>activity</code>. The latter being the number of beam crosses over a time bin (e.g. one minute). We could define a variable <code>moving</code> that is <code>TRUE</code> when and only when <code>activity &gt; 0</code>, and <code>FALSE</code> otherwise:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="zeitgebr.html#cb176-1" aria-hidden="true" tabindex="-1"></a>dt[, moving <span class="sc">:</span><span class="er">=</span> activity <span class="sc">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
</div>
<div id="overview-plots" class="section level3 unnumbered">
<h3>Overview plots</h3>
<p>The first representation we show could be the activity of all animals over time in the same page.
This would help to spot outliers.
We simply do that with our <strong>tile plot</strong>.
Note how we have changed the LD colours to grey and black, grey being for subjective days (remember, we are in DD).</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="zeitgebr.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggetho</span>(dt, <span class="fu">aes</span>(<span class="at">z=</span>activity)) <span class="sc">+</span></span>
<span id="cb177-2"><a href="zeitgebr.html#cb177-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_ld_annotations</span>(<span class="at">ld_colours =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb177-3"><a href="zeitgebr.html#cb177-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_tile_etho</span>() </span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-128-1.png" width="864" /></p>
<p>Note that you can substitute other variables you have in <code>dt</code> (e.g. <code>moving</code>) for <code>activity</code>.</p>
<p>We see that two animals (region 5 and 10) seem to have died/escaped before the end of the experiment.
There is no right thing to do regarding dead animals. You could keep the data before death, or remove them altogether.
<strong>It is eventually your responsibility to decide what to do with dead animals</strong>.
Here, I simply remove data after death:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="zeitgebr.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sleepr)</span>
<span id="cb178-2"><a href="zeitgebr.html#cb178-2" aria-hidden="true" tabindex="-1"></a>dt_curated <span class="ot">&lt;-</span> <span class="fu">curate_dead_animals</span>(dt)</span>
<span id="cb178-3"><a href="zeitgebr.html#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dt_curated)</span></code></pre></div>
<pre><code>## behavr table with:
##  32  individuals
##  6   metavariables
##  3   variables
##  4.06864e+05 measurements
##  1   key (id)</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="zeitgebr.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggetho</span>(dt_curated, <span class="fu">aes</span>(<span class="at">z=</span>activity)) <span class="sc">+</span></span>
<span id="cb180-2"><a href="zeitgebr.html#cb180-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_ld_annotations</span>(<span class="at">ld_colours =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb180-3"><a href="zeitgebr.html#cb180-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_tile_etho</span>() </span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<p>Our curated data is now stored in <code>dt_curated</code>.</p>
</div>
</div>
<div id="double-plotted-actograms-1" class="section level2 unnumbered">
<h2>Double plotted actograms</h2>
<p>At the moment, the <code>id</code> is a very long string (e.g. <code>"2017-01-16 08:00:00|dams_sample.txt|01"</code>). It has the advantage to be unambiguous, but it is difficult to plot.
To help plotting, we can make a new variable that is simply <strong>a different number for each individual</strong>. Lets call it <code>uid</code>:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="zeitgebr.html#cb181-1" aria-hidden="true" tabindex="-1"></a>dt_curated[, uid <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span> <span class="sc">:</span> .N, meta<span class="ot">=</span>T]</span>
<span id="cb181-2"><a href="zeitgebr.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We can map uid to id</span></span>
<span id="cb181-3"><a href="zeitgebr.html#cb181-3" aria-hidden="true" tabindex="-1"></a>dt_curated[, .(id, uid) ,meta<span class="ot">=</span>T]</span></code></pre></div>
<pre><code>##                                         id uid
##  1: 2017-01-16 08:00:00|dams_sample.txt|01   1
##  2: 2017-01-16 08:00:00|dams_sample.txt|02   2
##  3: 2017-01-16 08:00:00|dams_sample.txt|03   3
##  4: 2017-01-16 08:00:00|dams_sample.txt|04   4
##  5: 2017-01-16 08:00:00|dams_sample.txt|05   5
## ---                                           
## 28: 2017-01-16 08:00:00|dams_sample.txt|28  28
## 29: 2017-01-16 08:00:00|dams_sample.txt|29  29
## 30: 2017-01-16 08:00:00|dams_sample.txt|30  30
## 31: 2017-01-16 08:00:00|dams_sample.txt|31  31
## 32: 2017-01-16 08:00:00|dams_sample.txt|32  32</code></pre>
<p>As you see, we do keep <code>id</code> as a reference but <code>uid</code> for convenience in graphs.</p>
<p>To make a double plotted actogram, we use <code>ggetho</code>.
Read more about that in the <a href="ggetho.html#double-plotted-actograms">visualisation tutorial</a>.
Briefly, we set <code>multiplot</code> to <code>2</code> (<code>3</code> would be a triple plotted) one.
The variable of interest is on the <code>z</code> axis.
Note that instead of <code>moving</code>, you could plot raw <code>activity</code>.
Then, we use bar height to show the amount of movement (we could use <code>stat_tile_etho</code> which shows the variable of interest as a colour with pixel intensity).
Lastly, we split the graph by <code>uid</code>, so that each facet is a single animal.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="zeitgebr.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggetho</span>(dt_curated, <span class="fu">aes</span>(<span class="at">z =</span> moving), <span class="at">multiplot =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb183-2"><a href="zeitgebr.html#cb183-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_bar_tile_etho</span>() <span class="sc">+</span></span>
<span id="cb183-3"><a href="zeitgebr.html#cb183-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> uid, <span class="at">ncol =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-131-1.png" width="1152" /></p>
<p>Interestingly, you can use formula in facet to show or sort with other metavariables:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="zeitgebr.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggetho</span>(dt_curated, <span class="fu">aes</span>(<span class="at">z=</span>moving), <span class="at">multiplot =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb184-2"><a href="zeitgebr.html#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_bar_tile_etho</span>() <span class="sc">+</span></span>
<span id="cb184-3"><a href="zeitgebr.html#cb184-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> period_group <span class="sc">+</span> uid, <span class="at">ncol=</span><span class="dv">8</span>, <span class="at">labeller =</span> <span class="fu">label_wrap_gen</span>(<span class="at">multi_line=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-132-1.png" width="1152" />
Now, we know which genotype matches each <code>uid</code>.
In your own work, you could generalise this concept to display more metavariables.
For instance, if you had a <code>sex</code> metavariable you could do: <code>facet_wrap( ~ period_group + sex + uid, ...)</code>.</p>
</div>
<div id="periodograms-1" class="section level2 unnumbered">
<h2>Periodograms</h2>
<div id="computation" class="section level3 unnumbered">
<h3>Computation</h3>
<p>An important part of circadian research is to compute the periodicity of the free running clock of multiple individuals.
Mathematically, we would like to build a preiodogram. That is, generally speaking, a representation of the density (i.e. <strong>power</strong>) of a signal at different <strong>periods</strong> (or frequencies).
In addition, a periodogram associates to each pair of power-period a <strong>significance level</strong>.
There are many algorithms to compute periodograms.
In <code>zeitgebr</code>, we have so far implemented:</p>
<ul>
<li><code>ac_periodogram</code> – An <em>autocorrelation</em> based method</li>
<li><code>ls_periodogram</code> – <em>Lomb-Scargle</em> algorithm</li>
<li><code>chi_sq_periodogram</code> – A <em><span class="math inline">\(\chi{}^2\)</span></em> based one</li>
</ul>
<p>See <code>?periodogram_methods</code> for references.</p>
<p>In order to compute periodograms, we use the <code>periodogram()</code> function.
We need to define which variable we want to study (e.g. <code>moving</code> or <code>activity</code>).
Then, we provide our data.
The methods described above can be passed as an argument.</p>
<p>For instance, if we want to analyse, with the <span class="math inline">\(\chi{}^2\)</span> method, activity:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="zeitgebr.html#cb185-1" aria-hidden="true" tabindex="-1"></a>per_xsq_dt <span class="ot">&lt;-</span> <span class="fu">periodogram</span>(activity, </span>
<span id="cb185-2"><a href="zeitgebr.html#cb185-2" aria-hidden="true" tabindex="-1"></a>                        dt_curated,</span>
<span id="cb185-3"><a href="zeitgebr.html#cb185-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> chi_sq_periodogram)</span>
<span id="cb185-4"><a href="zeitgebr.html#cb185-4" aria-hidden="true" tabindex="-1"></a>per_xsq_dt</span></code></pre></div>
<pre><code>## 
##  ==== METADATA ====
## 
##                                         id file_info region_id
##                                     &lt;fctr&gt;    &lt;list&gt;     &lt;int&gt;
##  1: 2017-01-16 08:00:00|dams_sample.txt|01 &lt;list[2]&gt;         1
##  2: 2017-01-16 08:00:00|dams_sample.txt|02 &lt;list[2]&gt;         2
##  3: 2017-01-16 08:00:00|dams_sample.txt|03 &lt;list[2]&gt;         3
##  4: 2017-01-16 08:00:00|dams_sample.txt|04 &lt;list[2]&gt;         4
##  5: 2017-01-16 08:00:00|dams_sample.txt|05 &lt;list[2]&gt;         5
## ---                                                           
## 28: 2017-01-16 08:00:00|dams_sample.txt|28 &lt;list[2]&gt;        28
## 29: 2017-01-16 08:00:00|dams_sample.txt|29 &lt;list[2]&gt;        29
## 30: 2017-01-16 08:00:00|dams_sample.txt|30 &lt;list[2]&gt;        30
## 31: 2017-01-16 08:00:00|dams_sample.txt|31 &lt;list[2]&gt;        31
## 32: 2017-01-16 08:00:00|dams_sample.txt|32 &lt;list[2]&gt;        32
##                           experiment_id      start_datetime       stop_datetime
##                                  &lt;char&gt;              &lt;POSc&gt;              &lt;fctr&gt;
##  1: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  2: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  3: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  4: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  5: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## ---                                                                            
## 28: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 29: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 30: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 31: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 32: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##     period_group   uid
##           &lt;fctr&gt; &lt;int&gt;
##  1:         long     1
##  2:         long     2
##  3:         long     3
##  4:         long     4
##  5:         long     5
## ---                   
## 28:           wt    28
## 29:           wt    29
## 30:           wt    30
## 31:           wt    31
## 32:           wt    32
## 
##  ====== DATA ======
## 
##                                           id period     power signif_threshold
##                                       &lt;fctr&gt;  &lt;num&gt;     &lt;num&gt;            &lt;num&gt;
##    1: 2017-01-16 08:00:00|dams_sample.txt|01  57600  34.17475         116.7888
##    2: 2017-01-16 08:00:00|dams_sample.txt|01  57960  34.17475         116.7888
##    3: 2017-01-16 08:00:00|dams_sample.txt|01  58320  59.19905         118.1251
##    4: 2017-01-16 08:00:00|dams_sample.txt|01  58680  59.19905         118.1251
##    5: 2017-01-16 08:00:00|dams_sample.txt|01  59040  37.79175         119.4588
##   ---                                                                         
## 5148: 2017-01-16 08:00:00|dams_sample.txt|32 113760 100.21510         196.2269
## 5149: 2017-01-16 08:00:00|dams_sample.txt|32 114120 124.12366         197.4675
## 5150: 2017-01-16 08:00:00|dams_sample.txt|32 114480 124.12366         197.4675
## 5151: 2017-01-16 08:00:00|dams_sample.txt|32 114840 127.12975         198.7071
## 5152: 2017-01-16 08:00:00|dams_sample.txt|32 115200 127.12975         198.7071
##         p_value
##           &lt;num&gt;
##    1: 0.9991894
##    2: 0.9991894
##    3: 0.6793185
##    4: 0.6793185
##    5: 0.9979513
##   ---          
## 5148: 0.9561612
## 5149: 0.5556435
## 5150: 0.5556435
## 5151: 0.5051096
## 5152: 0.5051096</code></pre>
<p>The result is another <code>behavr</code> table, with the same metadata.
The data however, is now a list of power vs period (and significance).</p>
<p>Have a look at the other options (see <code>?periodogram</code>).</p>
</div>
<div id="peaks-finding" class="section level3 unnumbered">
<h3>Peaks finding</h3>
<p>Often, we want to know which are the peak periods in a periodogram.
This can be achieved thanks to the <code>find_peaks</code> function.
By default, it finds a maximum of three peaks, which are sorted by their power (relative to the significance thershold).
Peaks that are not signifant are not accounted for (see the <code>alpha</code> argument).</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="zeitgebr.html#cb187-1" aria-hidden="true" tabindex="-1"></a>per_xsq_dt <span class="ot">&lt;-</span> <span class="fu">find_peaks</span>(per_xsq_dt)</span>
<span id="cb187-2"><a href="zeitgebr.html#cb187-2" aria-hidden="true" tabindex="-1"></a>per_xsq_dt</span></code></pre></div>
<p>This function annotates our data by adding a column named <code>"peak"</code>.
Whenever the row corresponds to a peak, it puts a number and <code>NA</code> otherwise.
The number is the rank of the peak (<code>1</code> being the first/tallest one).</p>
</div>
<div id="visualisation" class="section level3 unnumbered">
<h3>Visualisation</h3>
<p>In <code>ggetho</code>, the function <code>ggperio()</code> is designed specifically for displaying periodograms.
One could plot all the periodograms like so:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="zeitgebr.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggperio</span>(per_xsq_dt) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id, <span class="at">colour=</span>period_group))</span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>But it is very hard to read, so we will <strong>facet per <code>uid</code></strong>.
In addition, we can use a special geometry (<code>geom_peak</code>) to show the values of the peak.
We draw a signifiance line as well, just using the <code>signif_threshold</code> variable:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="zeitgebr.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggperio</span>(per_xsq_dt) <span class="sc">+</span> </span>
<span id="cb189-2"><a href="zeitgebr.html#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id, <span class="at">colour =</span> period_group)) <span class="sc">+</span></span>
<span id="cb189-3"><a href="zeitgebr.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_peak</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-4"><a href="zeitgebr.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> signif_threshold)) <span class="sc">+</span></span>
<span id="cb189-5"><a href="zeitgebr.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> uid, <span class="at">ncol =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-136-1.png" width="1152" /></p>
<p>Instead of drawing only the first peak, you could draw, for instance, the first and second (<code>geom_peak(peak_rank = 1:2)</code>) or, only the second (<code>geom_peak(peak_rank = 2)</code>).</p>
<p>An interesting thing to do is a population average periodogram.
In this graph, the solid lines are the average power per group, whilst the shaded areas are ± standard error:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="zeitgebr.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggperio</span>(per_xsq_dt, <span class="fu">aes</span>(</span>
<span id="cb190-2"><a href="zeitgebr.html#cb190-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> power <span class="sc">-</span> signif_threshold,</span>
<span id="cb190-3"><a href="zeitgebr.html#cb190-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour=</span>period_group)) <span class="sc">+</span> </span>
<span id="cb190-4"><a href="zeitgebr.html#cb190-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">stat_pop_etho</span>()</span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="exctract-the-peak-values" class="section level3 unnumbered">
<h3>Exctract the peak values</h3>
<p>At some point, you would like to <strong>summarise</strong> each animal by, say, it first peak.
Then, you can look at whether there are significant differences in peak periodicity vs genotype.
Doing that is quite straightforward.
First, we <strong>select only rows where peak is exactly 1</strong>, then <a href="https://rethomics.github.io/behavr.html#operating-on-behavr-tables">rejoin</a> our table to its metadata:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="zeitgebr.html#cb191-1" aria-hidden="true" tabindex="-1"></a>summary_dt <span class="ot">&lt;-</span> <span class="fu">rejoin</span>(per_xsq_dt[peak<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb191-2"><a href="zeitgebr.html#cb191-2" aria-hidden="true" tabindex="-1"></a>summary_dt</span></code></pre></div>
<pre><code>##                                         id file_info region_id
##  1: 2017-01-16 08:00:00|dams_sample.txt|01 &lt;list[2]&gt;         1
##  2: 2017-01-16 08:00:00|dams_sample.txt|02 &lt;list[2]&gt;         2
##  3: 2017-01-16 08:00:00|dams_sample.txt|03 &lt;list[2]&gt;         3
##  4: 2017-01-16 08:00:00|dams_sample.txt|04 &lt;list[2]&gt;         4
##  5: 2017-01-16 08:00:00|dams_sample.txt|05 &lt;list[2]&gt;         5
##  6: 2017-01-16 08:00:00|dams_sample.txt|06 &lt;list[2]&gt;         6
##  7: 2017-01-16 08:00:00|dams_sample.txt|07 &lt;list[2]&gt;         7
##  8: 2017-01-16 08:00:00|dams_sample.txt|08 &lt;list[2]&gt;         8
##  9: 2017-01-16 08:00:00|dams_sample.txt|09 &lt;list[2]&gt;         9
## 10: 2017-01-16 08:00:00|dams_sample.txt|10 &lt;list[2]&gt;        10
## 11: 2017-01-16 08:00:00|dams_sample.txt|11 &lt;list[2]&gt;        11
## 12: 2017-01-16 08:00:00|dams_sample.txt|12 &lt;list[2]&gt;        12
## 13: 2017-01-16 08:00:00|dams_sample.txt|13 &lt;list[2]&gt;        13
## 14: 2017-01-16 08:00:00|dams_sample.txt|14 &lt;list[2]&gt;        14
## 15: 2017-01-16 08:00:00|dams_sample.txt|16 &lt;list[2]&gt;        16
## 16: 2017-01-16 08:00:00|dams_sample.txt|17 &lt;list[2]&gt;        17
## 17: 2017-01-16 08:00:00|dams_sample.txt|20 &lt;list[2]&gt;        20
## 18: 2017-01-16 08:00:00|dams_sample.txt|21 &lt;list[2]&gt;        21
## 19: 2017-01-16 08:00:00|dams_sample.txt|22 &lt;list[2]&gt;        22
## 20: 2017-01-16 08:00:00|dams_sample.txt|23 &lt;list[2]&gt;        23
## 21: 2017-01-16 08:00:00|dams_sample.txt|24 &lt;list[2]&gt;        24
## 22: 2017-01-16 08:00:00|dams_sample.txt|25 &lt;list[2]&gt;        25
## 23: 2017-01-16 08:00:00|dams_sample.txt|26 &lt;list[2]&gt;        26
## 24: 2017-01-16 08:00:00|dams_sample.txt|27 &lt;list[2]&gt;        27
## 25: 2017-01-16 08:00:00|dams_sample.txt|28 &lt;list[2]&gt;        28
## 26: 2017-01-16 08:00:00|dams_sample.txt|29 &lt;list[2]&gt;        29
## 27: 2017-01-16 08:00:00|dams_sample.txt|30 &lt;list[2]&gt;        30
## 28: 2017-01-16 08:00:00|dams_sample.txt|31 &lt;list[2]&gt;        31
## 29: 2017-01-16 08:00:00|dams_sample.txt|32 &lt;list[2]&gt;        32
##                                         id file_info region_id
##                           experiment_id      start_datetime       stop_datetime
##  1: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  2: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  3: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  4: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  5: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  6: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  7: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  8: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##  9: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 10: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 11: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 12: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 13: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 14: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 15: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 16: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 17: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 18: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 19: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 20: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 21: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 22: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 23: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 24: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 25: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 26: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 27: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 28: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
## 29: 2017-01-16 08:00:00|dams_sample.txt 2017-01-16 08:00:00 2017-01-26 00:09:00
##                           experiment_id      start_datetime       stop_datetime
##     period_group uid period    power signif_threshold      p_value peak
##  1:         long   1  99720 276.4555         177.4971 4.100760e-16    1
##  2:         long   2 100440 315.2950         178.7532 3.074761e-21    1
##  3:         long   3 100440 257.1494         178.7532 1.989846e-13    1
##  4:         long   4  95040 268.6532         171.1986 4.264752e-16    1
##  5:         long   5 100440 195.7411         178.7532 1.676299e-06    1
##  6:         long   6  96120 360.2246         172.4607 3.756396e-29    1
##  7:         long   7  98640 200.8368         176.2397 2.809713e-07    1
##  8:         long   8  99720 280.3768         177.4971 1.232934e-16    1
##  9:         long   9 101520 309.5947         180.0083 3.295280e-20    1
## 10:         long  10 103320 246.4732         182.5150 1.374486e-11    1
## 11:        short  11  68040 285.3857         132.6670 5.399920e-26    1
## 12:        short  12  69840 177.5452         135.2830 9.984131e-10    1
## 13:        short  13  67320 307.1445         131.3561 7.385662e-30    1
## 14:        short  14  69120 193.0421         133.9760 6.120254e-12    1
## 15:        short  16  69120 151.6117         133.9760 8.433567e-07    1
## 16:        short  17  69840 225.2747         135.2830 3.187945e-16    1
## 17:        short  20  69840 187.8997         135.2830 4.674815e-11    1
## 18:        short  21  68040 170.8709         132.6670 2.936584e-09    1
## 19:           wt  22  85320 176.0910         157.2301 8.538032e-07    1
## 20:           wt  23  88920 182.2338         162.3284 7.089435e-07    1
## 21:           wt  24  84240 204.4373         155.9519 3.618745e-10    1
## 22:           wt  25  86040 235.2866         158.5068 1.070912e-13    1
## 23:           wt  26  88920 233.0950         162.3284 7.960386e-13    1
## 24:           wt  27  87120 272.0614         159.7821 1.593002e-18    1
## 25:           wt  28  88920 273.3706         162.3284 2.955673e-18    1
## 26:           wt  29  88920 169.5197         162.3284 1.328092e-05    1
## 27:           wt  30  88920 301.1270         162.3284 2.880738e-22    1
## 28:           wt  31  86040 293.7774         158.5068 6.431675e-22    1
## 29:           wt  32  88920 168.8304         162.3284 1.546028e-05    1
##     period_group uid period    power signif_threshold      p_value peak</code></pre>
<p><code>summary_dt</code> can be used as a standard <code>R</code> dataframe for further analysis.
For instance, with <code>ggplot</code>, I make a <strong>boxplot showing the distribution of periods</strong>, in h, for each groups.
I also add <strong>a point for each animal</strong> (so we see outliers).
Then, I make the <strong>size of the points proportional to the relative power of the peak discovered</strong>, so we get an idea of how much to “trust” this point.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="zeitgebr.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_dt, <span class="fu">aes</span>(period_group, period, <span class="at">fill=</span> period_group)) <span class="sc">+</span> </span>
<span id="cb193-2"><a href="zeitgebr.html#cb193-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb193-3"><a href="zeitgebr.html#cb193-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">size=</span>power <span class="sc">-</span>  signif_threshold), <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb193-4"><a href="zeitgebr.html#cb193-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_hours</span>(<span class="at">name =</span> <span class="st">&quot;Period&quot;</span>) </span></code></pre></div>
<p><img src="rethomics_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>Another direction could be to perform pairwise wilcoxon tests between groups:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="zeitgebr.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(summary_dt<span class="sc">$</span>period, summary_dt<span class="sc">$</span>period_group )</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<pre><code>## 
##  Pairwise comparisons using Wilcoxon rank sum test with continuity correction 
## 
## data:  summary_dt$period and summary_dt$period_group 
## 
##       long  short
## short 5e-04 -    
## wt    3e-04 5e-04
## 
## P value adjustment method: holm</code></pre>
<p>This tells us that there is a statistically significant difference between each pair of groups.</p>
</div>
</div>
<div id="next-steps-4" class="section level2 unnumbered">
<h2>Next steps</h2>
<ul>
<li><a href="ggetho.html">Visualise data with <code>ggetho</code></a></li>
<li><a href="sleepr.html">Sleep analysis <code>sleepr</code></a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sleepr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="community.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rethomics/rethomics.github.io/edit/source/09-zeitgebr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rethomics.pdf", "rethomics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
